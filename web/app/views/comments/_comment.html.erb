<div class="d-flex flex-start no-shrink mt-4" id="comment_<%= comment.id %>">
  <div class="me-2 no-shrink">
    <%= render partial: 'shared/avatar', locals: { user: comment.user } %>
  </div>


  <div class="flex-grow-1 flex-shrink-1">
    <div class="d-flex justify-content-between align-items-center">
      <p class="mb-1">
        <%= link_to comment.user.username, user_path(comment.user) %> <span class="small">- <%= comment.created_at.strftime('%B %d, %Y') %></span>
      </p>

      <% if comment.user == current_user || current_user.moderator? %>
        <%= button_to 'Delete', polymorphic_path([comment.commentable, comment]), method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-sm btn-danger" %>
      <% end %>

      <%= form_with url: flag_comment_path(comment), method: :post do %>
        <%= submit_tag "Flag", class: "btn btn-sm btn-danger" %>
      <% end %>
    </div>
    <p class="small mb-0">
      <%= comment.content %>
    </p>

    <!-- Displaying replies -->
    <div class="mt-3">
      <strong>Replies:</strong>
      <% comment.replies.each do |reply| %>
        <div class="d-flex flex-start no-shrink mt-4" id="reply_<%= reply.id %>">
          <div class="me-2 no-shrink">
            <%= render partial: 'shared/avatar', locals: { user: reply.user } %>
          </div>
          <div class="flex-grow-1 flex-shrink-1">
            <div class="d-flex justify-content-between align-items-center">
              <p class="mb-1">
                <%= link_to reply.user.username, user_path(reply.user) %> <span class="small">- <%= reply.created_at.strftime('%B %d, %Y') %></span>

              </p>
            </div>
            <p class="small mb-0">
              <%= reply.content %>
            </p>
          </div>
        </div>
      <% end %>
    </div>

    <!-- Add a form to submit a reply to this comment -->
    <div class="mt-3">
      <%= render 'comments/reply_form', comment: comment %>
    </div>
  </div>
</div>
