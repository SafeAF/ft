<div class="container mt-5">
  <div class="row">
    <div class="col-md-12">
      <div class="d-flex align-items-center">
        <h1 class="mb-0 mr-3"><%= @user.username %>'s Profile</h1>
        <div class="mr-2">
          <%= render 'shared/send_message_button', user: @user %>
        </div>
        <div>
          <%= render 'shared/follow_button', user: @user %>
        </div>
      </div>
    
      <%= render partial: 'shared/avatar', locals: { user: @user } %>

      <%= link_to pluralize(@user.followers.count, 'Follower'), followers_user_path(@user) %>

      <%= link_to @user.following.count.to_s +  ' Following', following_user_path(@user) %>

    <div class="row">
      <div class="col-md-12">
      <% @user.badges.each do |badge| %>
        <div class="badge">
          <% if badge.image.attached? %>
            <%= image_tag badge.image.variant(:thumb), width: '50', height: '50', class: 'img-thumbnail mb-3' %>
          <% end %>
        </div>
       <% end %>
       </div>
      </div>

      <!-- User Actions -->
      <div class="mt-3 mb-3">
        <% if current_user == @user %>
          <%= link_to "Change Password", edit_user_registration_path, class: 'btn btn-warning' %>
          <%= link_to "Edit Bio", edit_bio_user_path(@user), class: 'btn btn-primary' %>
        <% end %>
      </div>

      <!-- Moderator Actions -->
      <% if current_user&.moderator? %>
        <%= button_to "Lock User", lock_user_path(@user), method: :post, class: 'btn btn-warning' %>
      <% end %>

      <!-- Flag User -->
      <% unless current_user == @user %>
        <%= button_to "Flag User", flag_user_path(@user), method: :post, class: 'btn btn-danger' %>
      <% end %>

      <!-- Bio -->
      <h2>Bio</h2>
      <% if @user.bio.present? %>
        <%= render partial: 'bio_card', locals: { bio: @user.bio } %>
      <% end %>

      <!-- User Interactions -->
      <%= render 'shared/send_message_button', user: @user %>
      <%= render 'shared/follow_button', user: @user %>
      
      <!-- User Activity -->
      <h2 class="mt-4">Activity</h2>
      <ul class="list-group">
        <li class="list-group-item"><%= link_to "View Comment History", comments_user_path(@user) %></li>
        <li class="list-group-item"><%= link_to "View Listings", listings_user_path(@user) %></li>
        <li class="list-group-item"><%= link_to "View Articles", articles_user_path(@user) %></li>
      </ul>

      <!-- Poasts -->
      <h2>Poasts</h2>
      <%= render partial: 'poast_cards', locals: { poasts: @poasts } %>

      <!-- Comments -->
      <%= render partial: 'shared/comments_section', locals: { comments: @comments, commentable: @user } %>

      <!-- Badges -->




    </div> <!-- col-md-12 -->
  </div> <!-- row -->
</div> <!-- container -->
